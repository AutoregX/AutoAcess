<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AccessLetter - OAuth 2.0</title>
    <script src="https://cdn.jsdelivr.net/npm/@azure/msal-browser@2.20.0/dist/msal-browser.min.js"></script>
    <script>
        const msalConfig = {
            auth: {
                clientId: "77417ba7-29b2-430e-a805-b81b72c79784",  // Ваш client_id
                authority: "https://login.microsoftonline.com/c452bad9-c8b6-4018-9374-277d0469401e",  // Ваш tenant_id
                redirectUri: "https://AutoregX.github.io/AutoAcess/"
            }
        };

        const msalInstance = new msal.PublicClientApplication(msalConfig);

        const loginRequest = {
            scopes: ["Mail.ReadWrite"]
        };

        function signIn() {
            msalInstance.loginPopup(loginRequest)
                .then(response => {
                    console.log('Signed in successfully:', response);
                    // Обработка успешного входа
                })
                .catch(error => {
                    console.error('Error during sign-in:', error);
                });
        }
    </script>
</head>
<body>
    <h1>Welcome to AccessLetter!</h1>
    <p>Click the button below to sign in with your Microsoft account and access your mail.</p>
    <button onclick="signIn()">Login with Microsoft</button>
</body>
</html>
